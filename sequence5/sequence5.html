<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√©quence 5 - Performance & S√©curit√© Angular</title>
     <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            height: 100vh;
        }

        .presentation-container {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .slide-counter {
            text-align: center;
            color: white;
            font-size: 1.2em;
            padding: 15px;
            font-weight: bold;
        }

        .slide {
            display: none;
            width: 90%;
            max-width: 1200px;
            margin: auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 60px;
            animation: slideIn 0.5s ease-out;
            overflow-y: auto;
            max-height: 80vh;
        }

        .slide.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #667eea;
            font-size: 2.8em;
            margin-bottom: 30px;
            border-bottom: 4px solid #667eea;
            padding-bottom: 15px;
        }

        h2 {
            color: #764ba2;
            font-size: 2em;
            margin: 25px 0 15px 0;
        }

        h3 {
            color: #555;
            font-size: 1.5em;
            margin: 20px 0 10px 0;
        }

        h4 {
            color: #667eea;
            font-size: 1.3em;
            margin: 15px 0 10px 0;
        }

        p, li {
            font-size: 1.2em;
            line-height: 1.8;
            color: #333;
            margin-bottom: 15px;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        li {
            margin-bottom: 10px;
        }

        .highlight {
            background: #fff3cd;
            padding: 20px;
            border-left: 5px solid #ffc107;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 5px solid #17a2b8;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        code {
            background: #f4f4f4;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #c7254e;
            font-size: 0.95em;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }

        pre code {
            background: transparent;
            color: #f8f8f2;
            padding: 0;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 20px;
        }

        .controls button {
            background: white;
            color: #667eea;
            border: 2px solid white;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .controls button:hover:not(:disabled) {
            background: #667eea;
            color: white;
            transform: scale(1.05);
        }

        .controls button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .date-badge {
            display: inline-block;
            background: #764ba2;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-bottom: 20px;
        }

        .emoji {
            font-size: 1.3em;
            margin-right: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-before {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }

        .comparison-after {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }

        strong {
            color: #667eea;
        }

        .step-number {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-right: 10px;
        }

        .flow-diagram {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .flow-step {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 5px;
            font-weight: bold;
        }
          .container {
        padding: 3rem;
        border-radius: 1rem;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
         .back-button {
                display: inline-flex;
                align-items: center;
                gap: 10px;
                background: white;
                color: #667eea;
                padding: 12px 25px;
                border-radius: 50px;
                text-decoration: none;
                font-weight: bold;
                transition: all 0.3s ease;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }
        .slide-counter {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            color: #667eea;
            z-index: 1000;
        }
    </style>
</head>
<body>
    
      <div class="presentation-container">

          <div class="container">
            <a href="../index.html" class="back-button">‚Üê Retour au dashboard</a>
            <div class="slide-counter">
                <span id="current-slide">1</span> / <span id="total-slides">30</span>
            </div>

        </div>
      
     

        <!-- Slide 1 -->
        <div class="slide active">
            <h1>üìä S√©quence 5</h1>
            <h2>Performance & S√©curit√© dans Angular</h2>
            <div class="date-badge">‚è±Ô∏è Dur√©e : 3h - 3h30</div>
            
            <div class="success-box">
                <h3>üéØ Objectifs de la s√©ance</h3>
                <p>√Ä la fin de cette s√©ance, vous serez capables de :</p>
                <ul>
                    <li><strong>Identifier</strong> les probl√®mes de performance dans une application Angular</li>
                    <li><strong>Utiliser</strong> Angular DevTools et Lighthouse pour auditer une app</li>
                    <li><strong>Mettre en ≈ìuvre</strong> des optimisations concr√®tes</li>
                    <li><strong>Comprendre</strong> et appliquer les bonnes pratiques de s√©curit√© front-end</li>
                    <li><strong>Pr√©venir</strong> les principales attaques : XSS, CSRF, injections</li>
                </ul>
            </div>
        </div>

        <!-- Slide 2 -->
        <div class="slide">
            <h1>‚ö° Qu'est-ce qu'un probl√®me de performance ?</h1>
            
            <div class="warning-box">
                <h3><span class="emoji">üêå</span> Sympt√¥mes d'une application lente</h3>
                <ul>
                    <li><strong>Temps de chargement</strong> : L'application met trop de temps √† d√©marrer</li>
                    <li><strong>Rendu lent</strong> : Les interactions utilisateur sont ralenties</li>
                    <li><strong>Change Detection excessive</strong> : Angular re-v√©rifie trop souvent</li>
                    <li><strong>DOM surcharg√©</strong> : Trop d'√©l√©ments HTML √† g√©rer</li>
                    <li><strong>Bundles lourds</strong> : Fichiers JavaScript trop volumineux</li>
                </ul>
            </div>

            <div class="highlight">
                <h3>üí° Exemples concrets dans TaskBoard Pro</h3>
                <ul>
                    <li>Liste de 1000 t√¢ches qui rame</li>
                    <li>Clic sur "Ajouter" qui prend 2 secondes</li>
                    <li>Toute la page se rafra√Æchit quand on modifie UNE seule t√¢che</li>
                    <li>Application de 5 Mo √† t√©l√©charger au d√©marrage</li>
                </ul>
            </div>

            <div class="info-box">
                <p><strong>R√®gle d'or :</strong> Une application performante = une meilleure exp√©rience utilisateur = plus de conversions !</p>
            </div>
        </div>

  

        <!-- Slide 3 -->
        <div class="slide">
            <h1>üõ†Ô∏è Angular DevTools</h1>
            
            <div class="info-box">
                <h3>üì• Installation</h3>
                <ol>
                    <li>Ouvrir Chrome Web Store</li>
                    <li>Rechercher "Angular DevTools"</li>
                    <li>Cliquer sur "Ajouter √† Chrome"</li>
                    <li>Ouvrir DevTools: F12(Windows) ou Cmd + Option + I (Mac)‚Üí Onglet "Angular"</li>
                </ol>
            </div>

            <div class="success-box">
                <h3>‚ú® Fonctionnalit√©s principales</h3>
                <ul>
                    <li><strong>Profiler</strong> : Enregistre et analyse les cycles de change detection</li>
                    <li><strong>Components</strong> : Inspecte l'arbre des composants</li>
                    <li><strong>Injector Tree</strong> : Visualise les d√©pendances</li>
                </ul>
            </div>

            <div class="highlight">
                <h3>üéØ Cas pratique : D√©tecter un re-render inutile</h3>
                <ol>
                    <li>Ouvrir Angular DevTools ‚Üí Profiler</li>
                    <li>Cliquer sur "Record" ‚è∫Ô∏è</li>
                    <li>Faire une action (clic sur "Ajouter t√¢che")</li>
                    <li>Cliquer sur "Stop" ‚èπÔ∏è</li>
                    <li>Observer : combien de composants se sont rafra√Æchis ?</li>
                </ol>
                <p><strong>Question :</strong> Est-ce que TOUS les composants devaient se rafra√Æchir ?</p>
            </div>
        </div>


        <!-- Slide 4 -->
        <div class="slide">
            <h1>‚è±Ô∏è DevTools Profiler : mesurer les re-renders</h1>

            <div class="info-box">
                <h3>üéØ Objectif</h3>
                <p>Identifier <strong>quels composants</strong> sont v√©rifi√©s (change detection) lors d‚Äôune action utilisateur.</p>
                <p><strong>R√®gle :</strong> on <em>mesure</em> avant d‚Äôoptimiser.</p>
            </div>

            <div class="highlight">
                <h3>üß™ D√©mo (TaskBoard Pro)</h3>
                <ol>
                    <li>Ouvrir l‚Äôapp ‚Üí DevTools ‚Üí <strong>Angular</strong> ‚Üí <strong>Profiler</strong></li>
                    <li>Cliquer sur <strong>Record</strong> ‚è∫Ô∏è</li>
                    <li>Faire une action : <strong>Ajouter une t√¢che</strong> (ou <strong>Terminer</strong>)</li>
                    <li>Cliquer sur <strong>Stop</strong> ‚èπÔ∏è</li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üîé Ce qu‚Äôon observe</h3>
                <ul>
                    <li><strong>Combien de composants</strong> se sont rafra√Æchis ?</li>
                    <li>Quels composants reviennent souvent ? (ex : <code>TasksPage</code>, <code>TaskStats</code>, <code>TaskHighlight</code>)</li>
                    <li>Est-ce logique par rapport √† l‚Äôaction faite ?</li>
                </ul>
                <p><strong>Question :</strong> Est-ce que tous ces composants <em>devaient</em> √™tre v√©rifi√©s ?</p>
            </div>

           
        </div>

        <!-- Slide 5 -->
        <div class="slide">
            <h1>üß© DevTools Components : comprendre l‚Äô√©tat et OnPush</h1>

            <div class="info-box">
                <h3>üéØ Objectif</h3>
                <p>Visualiser l‚Äô<strong>arbre des composants</strong> et comprendre <strong>pourquoi</strong> un composant se met √† jour.</p>
            </div>

            <div class="highlight">
                <h3>üß™ D√©mo (TaskBoard Pro)</h3>
                <ol>
                    <li>DevTools ‚Üí <strong>Angular</strong> ‚Üí <strong>Components</strong></li>
                    <li>S√©lectionner <code>TasksPage</code> puis <code>TaskStats</code></li>
                    <li>Faire une action : <strong>Ajouter</strong> / <strong>Terminer</strong> une t√¢che</li>
                    <li>Observer les valeurs et l‚Äô√©tat du composant s√©lectionn√©</li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üîé Ce qu‚Äôon observe</h3>
                <ul>
                    <li>La hi√©rarchie : qui est parent / enfant ?</li>
                    <li>Les <strong>valeurs en direct</strong> (ex : liste, compteurs, s√©lection)</li>
                    <li>La strat√©gie : <strong>Default</strong> vs <strong>OnPush</strong> (selon le composant)</li>
                </ul>
            </div>

            <div class="warning-box">
                <h3>üí° Utilit√© (concr√®te)</h3>
                <ul>
                    <li>D√©bugger un composant qui <strong>ne se met pas √† jour</strong> (r√©f√©rence immuable, @Input, async)</li>
                    <li>V√©rifier que le composant re√ßoit bien ses donn√©es (Input / √©tat)</li>
                    <li>Comprendre rapidement ¬´ qui affiche quoi ¬ª dans l‚ÄôUI</li>
                </ul>
            </div>
        </div>

        <!-- Slide 6 -->
        <div class="slide">
            <h1>üå≥ DevTools Injector Tree : comprendre les services et les scopes</h1>

            <div class="info-box">
                <h3>üéØ Objectif</h3>
                <p>V√©rifier <strong>d‚Äôo√π vient un service</strong> (root / composant) et √©viter les <strong>instances dupliqu√©es</strong>.</p>
            </div>

            <div class="highlight">
                <h3>üß™ D√©mo (TaskBoard Pro)</h3>
                <ol>
                    <li>DevTools ‚Üí <strong>Angular</strong> ‚Üí <strong>Injector Tree</strong></li>
                    <li>Rechercher le service <code>Task</code> (ou le service de t√¢ches)</li>
                    <li>Observer : il est fourni <strong>o√π</strong> ? (root ou ailleurs)</li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üîé Ce qu‚Äôon observe</h3>
                <ul>
                    <li>Le <strong>provider</strong> qui cr√©e l‚Äôinstance du service</li>
                    <li>Le chemin de r√©solution : quel injector fournit quoi ?</li>
                    <li>Si un service est instanci√© plusieurs fois (mauvais scope)</li>
                </ul>
            </div>

            <div class="warning-box">
                <h3>üí° Utilit√© (concr√®te)</h3>
                <ul>
                    <li>D√©bugger un √©tat qui ¬´ dispara√Æt ¬ª : service fourni au mauvais niveau</li>
                    <li>√âviter les <strong>services dupliqu√©s</strong> quand on met <code>providers: [...]</code> dans un composant</li>
                    <li>Comprendre la diff√©rence : <code>providedIn: 'root'</code> vs provider local</li>
                </ul>
            </div>
        </div>


















        <!-- Slide 7 -->
        <div class="slide">
            <h1>üí° Lighthouse (Chrome DevTools)</h1>
            
            <div class="info-box">
                <h3>üöÄ Lancer un audit Lighthouse</h3>
                <ol>
                    <li>Ouvrir Chrome DevTools (F12/ Cmd + option + i)</li>
                    <li>Onglet "Lighthouse"</li>
                    <li>Cocher "Performance"</li>
                    <li>Cliquer sur "Analyze page load"</li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üìä Lire les scores</h3>
                <ul>
                    <li><span class="score-badge score-excellent">90-100</span> : Excellent ‚úÖ</li>
                    <li><span class="score-badge score-good">50-89</span> : √Ä am√©liorer ‚ö†Ô∏è</li>
                    <li><span class="score-badge score-poor">0-49</span> : Probl√®mes critiques ‚ùå</li>
                </ul>
            </div>

            <div class="info-box">
                <h3>üîç M√©triques importantes</h3>
                <table>
                    <tbody>
                        <tr>
                            <td><strong>FCP</strong> (First Contentful Paint)</td>
                            <td>Temps avant le premier affichage</td>
                        </tr>
                        <tr>
                            <td><strong>LCP</strong> (Largest Contentful Paint)</td>
                            <td>Temps avant l'√©l√©ment principal</td>
                        </tr>
                        <tr>
                            <td><strong>TBT</strong> (Total Blocking Time)</td>
                            <td>Temps o√π la page est bloqu√©e</td>
                        </tr>
                        <tr>
                            <td><strong>CLS</strong> (Cumulative Layout Shift)</td>
                            <td>Stabilit√© visuelle</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="warning-box">
                <p><strong>‚ö†Ô∏è Attention :</strong> Lighthouse ‚â† v√©rit√© absolue. Toujours croiser avec Angular DevTools !</p>
            </div>
        </div>

        <!-- Slide : Comment utiliser Lighthouse -->
        <div class="slide">
            <h1>üß≠ Comment utiliser Lighthouse ?</h1>

            <div class="info-box">
                <h3>üéØ Objectif</h3>
                <p>
                    Utiliser <strong>Lighthouse</strong> pour obtenir un <strong>diagnostic global</strong>
                    de performance et identifier les <strong>axes d‚Äôam√©lioration prioritaires</strong>.
                </p>
            </div>

            <div class="highlight">
                <h3>üß™ √âtapes pas √† pas</h3>
                <ol>
                    <li>Ouvrir l‚Äôapplication Angular dans <strong>Chrome</strong></li>
                    <li>Ouvrir les DevTools : <code>F12</code> ou <code>Cmd + Option + I</code></li>
                    <li>Aller dans l‚Äôonglet <strong>Lighthouse</strong></li>
                    <li>Cocher <strong>Performance</strong> (et laisser les autres options par d√©faut)</li>
                    <li>Cliquer sur <strong>Analyze page load</strong></li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üìä Ce que Lighthouse analyse</h3>
                <ul>
                    <li>Temps de chargement initial (FCP, LCP)</li>
                    <li>JavaScript bloquant le thread principal</li>
                    <li>Poids des bundles et ressources</li>
                    <li>Stabilit√© visuelle (CLS)</li>
                </ul>
            </div>

            <div class="warning-box">
                <h3>‚ö†Ô∏è Bonnes pratiques d‚Äôinterpr√©tation</h3>
                <ul>
                    <li>Lighthouse donne une <strong>tendance</strong>, pas une v√©rit√© absolue</li>
                    <li>Toujours comparer <strong>avant / apr√®s optimisation</strong></li>
                    <li>Croiser les r√©sultats avec <strong>Angular DevTools</strong></li>
                </ul>
            </div>

            <div class="highlight">
                <h3>üí¨ Question √† se poser</h3>
                <p style="font-size: 1.3em; text-align: center;">
                    <strong>Quel est le probl√®me principal identifi√© par Lighthouse ?</strong><br>
                    (JS trop lourd ? rendu lent ? trop de calculs ?)
                </p>
            </div>
        </div>

        <!-- Slide 8 -->
        <div class="slide">
            <h1>üìà Exemple de rapport Lighthouse</h1>
            
            <div class="comparison">
                <div class="comparison-before">
                    <h3>‚ùå Avant optimisation</h3>
                    <p><strong>Performance :</strong> <span class="score-badge score-poor">45/100</span></p>
                    <ul>
                        <li>FCP : 3.2s</li>
                        <li>LCP : 5.8s</li>
                        <li>Bundle size : 2.8 MB</li>
                    </ul>
                    <p><strong>Probl√®mes identifi√©s :</strong></p>
                    <ul>
                        <li>üî¥ JavaScript bloquant : 1.2s</li>
                        <li>üî¥ Pas de lazy loading</li>
                        <li>üî¥ Images non optimis√©es</li>
                    </ul>
                </div>

                <div class="comparison-after">
                    <h3>‚úÖ Apr√®s optimisation</h3>
                    <p><strong>Performance :</strong> <span class="score-badge score-excellent">92/100</span></p>
                    <ul>
                        <li>FCP : 1.1s</li>
                        <li>LCP : 2.3s</li>
                        <li>Bundle size : 850 KB</li>
                    </ul>
                    <p><strong>Am√©liorations appliqu√©es :</strong></p>
                    <ul>
                        <li>‚úÖ Lazy loading des modules</li>
                        <li>‚úÖ OnPush change detection</li>
                        <li>‚úÖ Images optimis√©es (WebP)</li>
                    </ul>
                </div>
            </div>

            <div class="highlight">
                <h3>üéØ Gain de performance</h3>
                <p style="font-size: 1.5em; text-align: center;">
                    <strong>+47 points</strong> de score<br>
                    <strong>-70%</strong> de bundle size<br>
                    <strong>3x</strong> plus rapide !
                </p>
            </div>
        </div>



<!-- Slide 9 -->
<div class="slide">
  <h1>üîç Causes fr√©quentes de lenteur en Angular</h1>

  <div class="comparison">
    <div class="comparison-before">
      <h3>‚ùå Probl√®me 1 : Change Detection par d√©faut</h3>
      <p>
        Angular v√©rifie <strong>tous les composants</strong> √† chaque √©v√©nement
      </p>
      <pre><code>@Component({
  selector: 'app-tasks'
  // changeDetection: Default
})</code></pre>
      <p><strong>Impact :</strong> chaque clic d√©clenche une v√©rification globale</p>
    </div>

    <div class="comparison-after">
      <h3>‚úÖ Solution : OnPush</h3>
      <p>
        Angular v√©rifie le composant <strong>uniquement si ses @Input changent</strong>
      </p>
      <pre><code>@Component({
  selector: 'app-task-item',
  changeDetection: ChangeDetectionStrategy.OnPush
})</code></pre>
      <p><strong>Gain :</strong> beaucoup moins de cycles de v√©rification</p>
    </div>
  </div>

  <div class="warning-box">
    <h3>‚ùå Probl√®me 2 : Liste sans identit√© stable</h3>
    <pre><code>@for (task of tasks; track task) {   // ‚ùå objet utilis√© comme cl√©
  &lt;li&gt;{{ task.title }}&lt;/li&gt;
}</code></pre>
    <p>
      Angular ne peut pas savoir quel √©l√©ment a r√©ellement chang√©
    </p>
  </div>

  <div class="success-box">
    <h3>‚úÖ Solution : Tracking par identifiant</h3>
    <pre><code>@for (task of tasks; track task.id) { // ‚úÖ identit√© stable
  &lt;li&gt;{{ task.title }}&lt;/li&gt;
}</code></pre>
    <p>
      Angular r√©utilise le DOM et ne met √† jour que les √©l√©ments modifi√©s
    </p>
  </div>
</div>

<!-- Slide 10 -->
<div class="slide">
  <h1>üß™ Cas concret : filtre (recherche) + mauvais tracking</h1>

  <p class="intro">
    Dans <code>TasksPage</code>, on ajoute une recherche. Tout fonctionne‚Ä¶
    mais un mauvais <code>track</code> peut forcer Angular √† recr√©er trop d‚Äô√©l√©ments DOM.
  </p>

  <div class="comparison">
    <div class="comparison-before">
      <h3>Tentant : track par index (ou par objet)</h3>

      <p><strong>Fichier :</strong> <code>tasks-page.ts</code></p>
      <pre><code>// Ajout d'un terme de recherche
searchTerm = '';

filteredTasks$ = this.taskService.tasks$.pipe(
  map(tasks =&gt; tasks.filter(t =&gt;
    t.title.toLowerCase().includes(this.searchTerm.toLowerCase())
  ))
);</code></pre>

      <p><strong>Fichier :</strong> <code>tasks-page.html</code></p>
      <pre><code>&lt;input
  type="text"
  placeholder="Rechercher..."
  (input)="searchTerm = $any($event.target).value"
/&gt;

@for (t of filteredTasks$ | async; track $index) {  // ‚ùå mauvais
  &lt;li&gt;{{ t.title }}&lt;/li&gt;
}</code></pre>

      <p class="impact">
        <strong>Effet :</strong> en filtrant/triant, les indexes bougent.
        Angular r√©associe mal les √©l√©ments ‚Üí re-render inutile, focus/DOM instable.
      </p>
    </div>

    <div class="comparison-after">
      <h3> Recommand√© : track par identifiant stable</h3>

      <p><strong>Fichier :</strong> <code>tasks-page.html</code></p>
      <pre><code>@for (t of filteredTasks$ | async; track t.id) {   
  &lt;li&gt;{{ t.title }}&lt;/li&gt;
}</code></pre>

      <p class="gain">
        <strong>R√©sultat :</strong> Angular reconna√Æt chaque t√¢che et r√©utilise le DOM.
        La liste reste stable et performante pendant la recherche.
      </p>
    </div>
  </div>

  <div class="blue-box">
    <h3>‚ö†Ô∏è √Ä retenir</h3>
    <p>
      D√®s qu‚Äôune liste est <strong>filtr√©e, tri√©e ou recalcul√©e</strong>,
      privil√©gier un identifiant m√©tier (<code>id</code>).
    </p>
  </div>
</div>




<!-- Slide 11 -->
<div class="slide">
  <h1>‚öôÔ∏è Bonus : limiter les <code>| async</code> dans une m√™me page</h1>

  <p class="intro">
    Exemple r√©el dans <code>tasks-page.html</code> : Vous affichez peut-√™tre deux listes filtr√©es.
    C‚Äôest correct‚Ä¶ mais cela peut multiplier les abonnements et les recalculs.
  </p>

  <div class="comparison">
    <div class="comparison-before">
      <h3>‚úÖ Fonctionne‚Ä¶ mais 2 async + 2 filtres</h3>
      <p><strong>Fichier :</strong> <code>tasks-page.html</code></p>

      <pre><code>&lt;h3&gt;T√¢ches en cours&lt;/h3&gt;
@for (t of activeTasks$ | async; track t.id) {
  &lt;li&gt;{{ t.title }}&lt;/li&gt;
}

&lt;h3&gt;T√¢ches termin√©es&lt;/h3&gt;
@for (t of completedTasks$ | async; track t.id) {
  &lt;li&gt;{{ t.title }}&lt;/li&gt;
}</code></pre>

      <p class="impact">
        <strong>Effet :</strong> 2 abonnements + 2 filtres recalcul√©s √† chaque mise √† jour.
        Sur une grosse liste ou une recherche live, √ßa peut co√ªter.
      </p>
    </div>

    <div class="comparison-after">
      <h3>‚úÖ Solution : un seul <code>async</code>, puis filtrage en m√©moire</h3>
      <p><strong>Fichier :</strong> <code>tasks-page.html</code></p>

      <pre><code>@if (tasks$ | async; as tasks) {

  &lt;h3&gt;T√¢ches en cours&lt;/h3&gt;
  @for (t of tasks.filter(x =&gt; !x.completed); track t.id) {
    &lt;li&gt;{{ t.title }}&lt;/li&gt;
  }

  &lt;h3&gt;T√¢ches termin√©es&lt;/h3&gt;
  @for (t of tasks.filter(x =&gt; x.completed); track t.id) {
    &lt;li&gt;{{ t.title }}&lt;/li&gt;
  }

} @else {
  &lt;p&gt;Chargement...&lt;/p&gt;
}</code></pre>

      <p class="gain">
        <strong>R√©sultat :</strong> 1 abonnement (1 async) + rendu plus pr√©visible.
        On optimise seulement si on observe un probl√®me r√©el.
      </p>
    </div>
  </div>

  <div class="success-box">
    <h3>‚úÖ √Ä retenir</h3>
    <p>
      <code>| async</code> est une bonne pratique.  
      On r√©duit le nombre d‚Äôabonnements <strong>uniquement</strong> quand on mesure un co√ªt
      (DevTools / Lighthouse).
    </p>
  </div>
</div>

 <!-- Slide 12 -->
        <div class="slide">
            <h1>üéØ Optimisation 1 : OnPush</h1><div class="info-box">
  <h3>ü§î √Ä quoi sert OnPush ?</h3>
  <p>
    Par d√©faut, Angular relance la d√©tection de changements
    <strong>sur tous les composants</strong> √† chaque √©v√©nement
    (clic, timer, requ√™te HTTP‚Ä¶).
  </p>
  <p>
    <strong>OnPush</strong> permet de limiter ce travail en disant √† Angular :
    <em>¬´ ne v√©rifie ce composant que s‚Äôil a une bonne raison ¬ª</em>.
  </p>
  <p>
    R√©sultat :
    <strong>moins de calculs</strong>, moins de re-render,
    et une application plus fluide.
  </p>
</div>

    
            
            <div class="comparison">
                <div class="comparison-before">
                    <h3>‚ùå Par d√©faut (lent)</h3>
                    <p>Angular v√©rifie TOUS les composants √† CHAQUE √©v√©nement</p>
                    <pre><code>import { Component, Input } from '@angular/core';

@Component({
  selector: 'app-task-highlight',
  template: `
    &lt;div class="task-highlight"&gt;
      &lt;h3&gt;T√¢che mise en avant&lt;/h3&gt;
      &lt;h2&gt;{{ title }}&lt;/h2&gt;
    &lt;/div&gt;
  `
})
export class TaskHighlight {
  @Input() title = '';
}

// V√©rifi√© √† CHAQUE √©v√©nement de l'app !</code></pre>
                </div>

                <div class="comparison-after">
                    <h3>‚úÖ Avec OnPush (rapide)</h3>
                    <p>Angular v√©rifie uniquement si le @Input a chang√©</p>
                    <pre><code>import { Component, Input, ChangeDetectionStrategy } from '@angular/core';

@Component({
  selector: 'app-task-highlight',
  changeDetection: ChangeDetectionStrategy.OnPush,
  template: `
    &lt;div class="task-highlight"&gt;
      &lt;h3&gt;T√¢che mise en avant&lt;/h3&gt;
      &lt;h2&gt;{{ title }}&lt;/h2&gt;
    &lt;/div&gt;
  `
})
export class TaskHighlight {
  @Input() title = '';
}

// V√©rifi√© SEULEMENT si title change !</code></pre>
                </div>
            </div>

            <div class="success-box">
                <h3>üìä Gain de performance</h3>
                <p style="font-size: 1.3em; text-align: center;">
                    <strong>99%</strong> de v√©rifications en moins ! üöÄ
                </p>
            </div>
        </div>


<!-- Slide 13 - Quand utiliser OnPush -->
        <div class="slide">
            <h1>ü§î Quand utiliser OnPush dans TaskBoard Pro ?</h1>
            
            <div class="warning-box">
                <h3>‚ö†Ô∏è Ce qu'OnPush n'est PAS</h3>
                <p>
                    <strong>OnPush n'interdit pas l'√©tat interne</strong> et ne bloque pas les mises √† jour.<br>
                    Il modifie uniquement <strong>quand Angular relance la d√©tection</strong> pour ce composant.
                </p>
            </div>

            <div class="success-box">
                <h3>‚úÖ Dans TaskBoard Pro, mettre OnPush sur :</h3>
                
                <h4>1Ô∏è‚É£ TaskHighlight </h4>
                <pre><code>@Component({
  selector: 'app-task-highlight',
  changeDetection: ChangeDetectionStrategy.OnPush, // ‚úÖ
})
export class TaskHighlight {
  @Input() title = '';  // Ne d√©pend QUE de cet @Input
}</code></pre>
                <p><strong>Pourquoi ?</strong> Composant pur de pr√©sentation, pas d'√©tat interne</p>

                <h4>2Ô∏è‚É£ TasksPage</h4>
                <pre><code>@Component({
  selector: 'app-tasks-page',
  changeDetection: ChangeDetectionStrategy.OnPush, // ‚úÖ
})
export class TasksPage {
  tasks$ = this.taskService.tasks$; // Observable avec | async
  
  addTask(title: string): void {
    this.taskService.addTask(title); // √âv√©nement d√©clenche d√©tection
  }
}</code></pre>
                <p><strong>Pourquoi ?</strong> Utilise des Observables + les clics d√©clenchent automatiquement la d√©tection</p>

                <h4>3Ô∏è‚É£ TaskEditComponent (√† ajouter)</h4>
                <pre><code>@Component({
  selector: 'app-task-edit',
  changeDetection: ChangeDetectionStrategy.OnPush, // ‚Üê √Ä AJOUTER
})
export class TaskEditComponent {
  @Input() title = '';
  @Input() taskId = 0;
  @Output() onSave = new EventEmitter&lt;{id: number, title: string}&gt;();
  
  save(newTitle: string) {
    this.onSave.emit({ id: this.taskId, title: newTitle });
  }
}</code></pre>
                <p><strong>Pourquoi ?</strong> Pattern @Input/@Output pur, pas de modification interne</p>
            </div>

       

            <div class="info-box">
                <h3>üîë Angular re-v√©rifie un composant OnPush quand :</h3>
                <ul>
                    <li><strong>Un @Input change de r√©f√©rence</strong>
                        <pre><code>// Dans TaskService
this.tasksSubject.next([...currentTasks, newTask]); // ‚úÖ Nouvelle r√©f√©rence</code></pre>
                    </li>
                    <li><strong>Un √©v√©nement vient du composant</strong>
                        <pre><code>// Dans TasksPage
&lt;button (click)="addTask(title)"&gt; // ‚úÖ Clic d√©clenche d√©tection</code></pre>
                    </li>
                    <li><strong>Un Observable √©met via | async</strong>
                        <pre><code>// Dans le template
@if (tasks$ | async; as tasks) { ... } // ‚úÖ Auto-d√©tection</code></pre>
                    </li>
                </ul>
            </div>

            <div class="highlight">
                <h3>üéØ R√®gle d'or pour TaskBoard Pro</h3>
                <p style="font-size: 1.3em; text-align: center;">
                    <strong>OnPush marche parfaitement si le composant :<br>
                    ‚Ä¢ Re√ßoit des donn√©es via @Input / Observable<br>
                    ‚Ä¢ √âmet des √©v√©nements via @Output / clics<br>
                    ‚Ä¢ Ne manipule PAS le DOM dynamiquement (ViewContainerRef)</strong>
                </p>
            </div>
        </div>


   <!-- Slide 14 -->
<div class="slide">
  <h1>üéØ Optimisation 2 : trackBy</h1>

  <div class="info-box">
  <h3>ü§î √Ä quoi sert trackBy ?</h3>
  <p>
    Quand Angular affiche une liste, il doit d√©cider
    <strong>quel √©l√©ment correspond √† quel item de donn√©es</strong>.
  </p>
  <p>
    <strong>Sans trackBy</strong>, Angular compare les √©l√©ments par leur position
    et peut recr√©er inutilement le DOM.
  </p>
  <p>
    <strong>Avec trackBy</strong>, Angular utilise une <em>cl√© stable</em> (ex : <code>id</code>)
    pour mettre √† jour uniquement les √©l√©ments qui ont r√©ellement chang√©.
  </p>
</div>

  <div class="comparison">
    <div class="comparison-before">
      <h3>‚ùå Sans trackBy (lent)</h3>
      <p>Angular ne sait pas identifier les √©l√©ments ‚Üí recr√©ation inutile du DOM</p>
      <pre><code>@for (task of tasks) {
  &lt;li&gt;{{ task.title }}&lt;/li&gt;
}

// Si on ajoute 1 t√¢che
// ‚Üí Angular retravaille toute la liste</code></pre>
    </div>

    <div class="comparison-after">
      <h3>‚úÖ Avec trackBy (rapide)</h3>
      <p>Angular identifie chaque √©l√©ment gr√¢ce √† une cl√© stable</p>
      <pre><code>@for (task of tasks; track task.id) {
  &lt;li&gt;{{ task.title }}&lt;/li&gt;
}

// Si on ajoute 1 t√¢che
// ‚Üí Angular met √† jour 1 seul √©l√©ment</code></pre>
    </div>
  </div>

  <div class="success-box">
    <h3>üìä Impact sur une liste de 1000 t√¢ches</h3>
    <p>
      <strong>trackBy est indispensable avec OnPush</strong> pour √©viter
      des recalculs inutiles.
    </p>
    <ul>
      <li><strong>Sans trackBy :</strong> recalcul global de la liste</li>
      <li><strong>Avec trackBy :</strong> mise √† jour cibl√©e</li>
      <li><strong>Gain :</strong> performances fortement am√©lior√©es üöÄ</li>
    </ul>
  </div>
</div>

  <!-- Slide 15 : Lighthouse en dev vs production -->
        <div class="slide">
            <h1>‚ö†Ô∏è Lighthouse : d√©veloppement ‚â† production</h1>

            <div class="warning-box">
                <h3>üöß Attention au contexte d‚Äôanalyse</h3>
                <p>
                    Un score Lighthouse √©lev√© sur <strong>localhost</strong> ne garantit pas
                    une performance optimale en conditions r√©elles.
                </p>
                <p>
                    En d√©veloppement, certaines optimisations navigateur
                    (<strong>minification, compression, cache</strong>) ne sont pas actives
                    ou sont simul√©es.
                </p>
            </div>

            <div class="comparison">
                <div class="comparison-before">
                    <h3>üîß Audit en d√©veloppement</h3>
                    <ul>
                        <li>Code JavaScript parfois non minifi√©</li>
                        <li>Chargement via serveur de dev</li>
                        <li>Scores parfois trompeurs (trop optimistes ou trop pessimistes)</li>
                    </ul>
                    <p><strong>Objectif :</strong> d√©tecter des tendances et des probl√®mes grossiers</p>
                </div>

                <div class="comparison-after">
                    <h3>üöÄ Audit en production</h3>
                    <ul>
                        <li>JavaScript minifi√© et optimis√©</li>
                        <li>Tree-shaking et lazy loading effectifs</li>
                        <li>R√©sultats repr√©sentatifs pour les utilisateurs</li>
                    </ul>
                    <p><strong>Objectif :</strong> mesurer la performance r√©elle</p>
                </div>
            </div>

            <div class="info-box">
                <h3>üß™ Bonne pratique recommand√©e</h3>
                <ol>
                    <li>Lancer un <code>ng build</code> (ou build production)</li>
                    <li>Servir le dossier <code>dist/&lt;app&gt;/browser</code></li>
                    <li>Relancer Lighthouse sur l‚Äôapplication build√©e</li>
                    <li>Comparer <strong>avant / apr√®s</strong></li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üéØ Message cl√©</h3>
                <p style="font-size: 1.3em; text-align: center;">
                    <strong>Lighthouse est un outil de mesure : le contexte compte autant que le score.</strong>
                </p>
            </div>
        </div>

        <!-- Slide 16 -->
        <div class="slide">
            <h1>üîí S√©curit√© c√¥t√© front-end</h1>
            
            <div class="warning-box">
                <h3>‚ö†Ô∏è Pourquoi le front est une surface d'attaque ?</h3>
                <ul>
                    <li><strong>Donn√©es utilisateur</strong> : Input, formulaires, URLs</li>
                    <li><strong>APIs externes</strong> : Appels HTTP, webhooks</li>
                    <li><strong>DOM manipul√© dynamiquement</strong> : innerHTML, scripts</li>
                    <li><strong>Code client visible</strong> : Tout peut √™tre inspect√©</li>
                </ul>
            </div>

            <div class="info-box">
                <h3>üõ°Ô∏è Les 3 principales menaces front-end</h3>
                <ol style="font-size: 1.3em; line-height: 2;">
                    <li><strong>XSS</strong> (Cross-Site Scripting)</li>
                    <li><strong>CSRF</strong> (Cross-Site Request Forgery)</li>
                    <li><strong>Injection de code</strong></li>
                </ol>
            </div>

            <div class="highlight">
                <h3>üí° R√®gle fondamentale</h3>
                <p style="font-size: 1.5em; text-align: center; font-weight: bold;">
                    "Ne jamais faire confiance aux donn√©es utilisateur"
                </p>
            </div>
        </div>

        <!-- Slide 17 -->
        <div class="slide">
            <h1>‚ö†Ô∏è XSS (Cross-Site Scripting)</h1>
            
            <div class="warning-box">
                <h3>üî¥ Principe de l'attaque XSS</h3>
                <p>Un attaquant injecte du code JavaScript malveillant dans votre application</p>
                <pre><code>// Exemple d'input malveillant
const maliciousInput = '&lt;script&gt;alert("Hack√©!")&lt;/script&gt;';

// Si affich√© sans protection :
&lt;div&gt;{{ maliciousInput }}&lt;/div&gt;
// ‚Üí Le script s'ex√©cute !</code></pre>
            </div>

            <div class="highlight">
                <h3>üí° Exemple concret dans TaskBoard</h3>
                <pre><code>// Un utilisateur ajoute une "t√¢che" malveillante :
addTask('&lt;img src=x onerror="alert(document.cookie)"&gt;');

// Si affich√© sans protection, le script vole les cookies !</code></pre>
            </div>

            <div class="info-box">
                <h3>üéØ Types de XSS</h3>
                <ul>
                    <li><strong>Stored XSS</strong> : Le code est stock√© dans la base de donn√©es</li>
                    <li><strong>Reflected XSS</strong> : Le code est dans l'URL</li>
                    <li><strong>DOM-based XSS</strong> : Le code manipule le DOM directement</li>
                </ul>
            </div>
        </div>



<!-- New XSS-->

<div class="slide">
  <h1>üõ°Ô∏è XSS : comment Angular vous prot√®ge</h1>



<div class="success-box">
  <h3>‚úÖ Protection automatique avec {{ }}</h3>

  <pre><code>// Donn√©e utilisateur malveillante
task.title = '&lt;script&gt;alert("XSS")&lt;/script&gt;';

// Template Angular
&lt;div&gt;{{ task.title }}&lt;/div&gt;
</code></pre>

  <p>
    ‚û°Ô∏è Angular √©chappe le HTML automatiquement.<br>
    Le script est affich√© comme du texte, <strong>il n‚Äôest jamais ex√©cut√©</strong>.
  </p>
</div>

<div class="warning-box">
  <h3>‚ö†Ô∏è Tentation fr√©quente : innerHTML</h3>

  <p>
    Parfois, on veut afficher du HTML dynamique
    (mise en forme, contenu riche, CMS‚Ä¶).
  </p>

  <pre><code>// Tentation
&lt;div [innerHTML]="task.description"&gt;&lt;/div&gt;</code></pre>

  <ul>
    <li>‚ö†Ô∏è Surface d‚Äôattaque plus large</li>
    <li>‚ö†Ô∏è Code plus difficile √† auditer</li>
    <li>‚ö†Ô∏è Risque si mal utilis√©</li>
  </ul>
</div>

<div class="info-box">
  <h3>üîê DomSanitizer : le garde-fou Angular</h3>

  <p>
    <strong>DomSanitizer est un service Angular de s√©curit√©.</strong><br>
    Il sert √† nettoyer du contenu potentiellement dangereux
    avant de l‚Äôinjecter dans le DOM.
  </p>

  <p>
    Angular l‚Äôutilise d√©j√† automatiquement,
    mais il peut √™tre utilis√© explicitement
    dans des cas pr√©cis.
  </p>

   <h3>üìå Cas o√π DomSanitizer est l√©gitime</h3>
  <ul>
    <li>üìù Contenu CMS</li>
    <li>üßæ Markdown transform√© en HTML</li>
    <li>‚úçÔ∏è √âditeur riche</li>
    <li>üåê HTML venant d‚Äôune API de confiance</li>
  </ul>

  <p>
    ‚û°Ô∏è Dans ces cas, <strong>le HTML est attendu</strong>,
    mais il doit rester sous contr√¥le.
  </p>
</div>





<div class="success-box">
  <h3>üß© Exemple concret : afficher du HTML de mani√®re s√©curis√©e</h3>

  <p>
    Cas r√©el : description provenant d‚Äôun CMS ou d‚Äôun Markdown converti en HTML.
  </p>

  <pre><code>// task-description.component.ts
import { DomSanitizer, SecurityContext } from '@angular/platform-browser';

sanitize(html: string): string {
  return this.sanitizer.sanitize(SecurityContext.HTML, html) ?? '';
}</code></pre>

  <pre><code>// Template
&lt;div [innerHTML]="sanitize(task.description)"&gt;&lt;/div&gt;</code></pre>

  <p>
    ‚úÖ Le HTML est affich√©<br>
    ‚úÖ Les scripts et attributs dangereux sont supprim√©s
  </p>
</div>



<div class="warning-box">
  <h3>‚ö†Ô∏è bypassSecurityTrustHtml : un outil √† utiliser dans des cas exceptionnel</h3>

  <p>
    Cette m√©thode permet d‚Äôindiquer √† Angular :
  </p>

  <blockquote style="font-style: italic; margin: 1rem 0;">
    ‚ÄúCe contenu est s√ªr, j‚Äôen prends la responsabilit√©.‚Äù
  </blockquote>

  <pre><code>// HTML totalement consid√©r√© comme fiable
this.sanitizer.bypassSecurityTrustHtml(html);</code></pre>

  <p>
    Elle existe pour des <strong>cas tr√®s sp√©cifiques</strong>,
    o√π le HTML est <strong>enti√®rement ma√Ætris√©</strong>.
  </p>

<h3>Pourquoi bypass est presque toujours une mauvaise id√©e</h3>

  <ul>
    <li>‚ùå Angular ne nettoie plus rien</li>
    <li>‚ùå Les scripts sont ex√©cut√©s tels quels</li>
    <li>‚ùå Une seule donn√©e compromise = faille XSS</li>
    <li>‚ùå Erreur humaine tr√®s fr√©quente</li>
  </ul>

  <p>
    üëâ Ce n‚Äôest pas une faille Angular,<br>
    c‚Äôest une <strong>responsabilit√© d√©veloppeur</strong>.
  </p>
</div>


<div class="success-box">
  <h3>üéØ R√®gle d‚Äôor XSS dans Angular</h3>

  <ul style="font-size: 1.2em;">
    <li>‚úÖ Utiliser {{ }} par d√©faut</li>
    <li>‚ö†Ô∏è Utiliser innerHTML seulement si n√©cessaire</li>
    <li>üîê sanitize() pour contr√¥ler le HTML</li>
    <li>üö® bypass uniquement avec justification m√©tier claire</li>
    <li>üõ°Ô∏è La validation back-end reste indispensable</li>
  </ul>
</div>
    </div>









        <!-- Slide 19 -->
        <div class="slide">
            <h1>‚úÖ Bonnes pratiques XSS</h1>
            
            <div class="success-box">
                <h3>üéØ Ce qu'il faut TOUJOURS faire</h3>
                <ol style="font-size: 1.2em; line-height: 2;">
                    <li><strong>Utiliser l'interpolation normale</strong>
                        <pre><code>‚úÖ {{ task.title }}  &lt;!-- S√©curis√© par d√©faut --&gt;</code></pre>
                    </li>
                    <li><strong>√âviter innerHTML autant que possible</strong>
                        <pre><code>‚ùå [innerHTML]="..."  &lt;!-- Dangereux --&gt;
‚úÖ {{ ... }}           &lt;!-- Pr√©f√©rable --&gt;</code></pre>
                    </li>
                    <li><strong>Valider c√¥t√© serveur AUSSI</strong>
                        <pre><code>// Le front n'est PAS suffisant !
// Le back doit AUSSI valider les donn√©es</code></pre>
                    </li>
                </ol>
            </div>

            <div class="warning-box">
                <h3>üî¥ Ce qu'il ne faut JAMAIS faire</h3>
                <ul style="font-size: 1.2em;">
                    <li>‚ùå Utiliser <code>bypassSecurityTrustHtml()</code> sans raison valide</li>
                    <li>‚ùå D√©sactiver la protection Angular</li>
                    <li>‚ùå Faire confiance aux donn√©es utilisateur</li>
                    <li>‚ùå Penser que le front suffit pour la s√©curit√©</li>
                </ul>
            </div>
        </div>

    

     

<!-- Slide CSRF (version p√©dagogique : g√©n√©ral ‚Üí exemple) -->
<div class="slide">
  <h1>üß® CSRF : une action d√©clench√©e √† votre place</h1>

  <div class="warning-box">
    <h3>üî¥ Description g√©n√©rale</h3>
    <p>
      <strong>CSRF (Cross-Site Request Forgery)</strong> : un attaquant pousse le navigateur
      d‚Äôun utilisateur <strong>d√©j√† connect√©</strong> √† envoyer une requ√™te vers votre site
      <strong>sans son intention</strong>.
    </p>
    <ul>
      <li>‚úÖ Le pirate ne vole pas le mot de passe</li>
      <li>‚úÖ Il profite d‚Äôune <strong>session ouverte</strong> (cookies)</li>
      <li>‚úÖ Le navigateur envoie les cookies <strong>automatiquement</strong></li>
    </ul>
  </div>

  <div class="info-box">
    <h3>üìå D‚Äôo√π peut venir le d√©clencheur ?</h3>
    <ul>
      <li>üìß Un lien dans un <strong>email</strong> (phishing / newsletter compromise)</li>
      <li>üåê Une page web malveillante ouverte dans un onglet</li>
      <li>üí¨ Un lien dans un chat (Teams / Slack / Discord)</li>
      <li>üì∞ Une pub / un contenu embarqu√© (iframe / image)</li>
    </ul>
    <p>
      üëâ Peu importe la source : <strong>le navigateur peut d√©clencher une requ√™te</strong>.
    </p>
  </div>

  <div class="highlight">
    <h3>üé¨ Exemple concret (le plus simple √† comprendre)</h3>
    <ol>
      <li>Vous √™tes connect√© sur <strong>taskboard.com</strong> (cookie de session actif)</li>
      <li>Vous cliquez un lien re√ßu (mail / site) ‚Üí <strong>site-malveillant.com</strong></li>
      <li>La page contient un √©l√©ment invisible :</li>
      <pre><code>&lt;img src="https://taskboard.com/api/tasks/delete/123"&gt;</code></pre>
      <li>Le navigateur charge l‚Äôimage‚Ä¶ et envoie la requ√™te avec vos cookies :</li>
      <pre><code>GET /api/tasks/delete/123
Cookie: session=abc123</code></pre>
      <li>Le serveur voit un cookie valide ‚Üí il ex√©cute l‚Äôaction ‚Üí t√¢che supprim√©e</li>
    </ol>
  </div>
</div>
  
<!-- Slide CSRF : protections (Angular + c√¥t√© serveur) -->
<div class="slide">
  <h1>üõ°Ô∏è CSRF : comment s‚Äôen prot√©ger (Angular + API)</h1>

  <div class="info-box">
    <h3>üéØ Id√©e cl√©</h3>
    <p>
      Le CSRF vise surtout les applications qui s‚Äôauthentifient via <strong>cookies de session</strong>.
      <br>
      üëâ La protection est principalement <strong>c√¥t√© serveur</strong>, mais Angular participe (envoi du token).
    </p>
  </div>

 <div class="warning-box">
  <h3>‚úÖ 1) Utiliser un token CSRF (Synchronizer Token)</h3>

  <p>
    Le token CSRF permet de r√©pondre √† une question essentielle :
  </p>

  <p style="font-weight: bold; margin: 1rem 0;">
    ‚ùì ¬´ Si l‚Äôutilisateur est connect√©, pourquoi le token CSRF emp√™che l‚Äôattaque ? ¬ª
  </p>

  <p>
    üëâ Parce que le token CSRF prouve <strong>l‚Äôintention de l‚Äôutilisateur</strong>,
    pas seulement son identit√©.
  </p>

  <p style="font-weight: bold; margin-top: 1rem;">
    üîë Diff√©rence fondamentale : identit√© vs intention
  </p>

  <hr>

  <p><strong>‚ùå Sans token CSRF</strong></p>
  <ul>
    <li>Le serveur v√©rifie uniquement : ‚ÄúL‚Äôutilisateur est-il connect√© ?‚Äù</li>
    <li>‚û°Ô∏è Cookie de session valide ‚Üí requ√™te accept√©e</li>
  </ul>

  <p>
    ‚ö†Ô∏è Probl√®me : le navigateur envoie le cookie automatiquement,
    m√™me si la requ√™te est d√©clench√©e depuis un site externe.
  </p>

  <p>
    üëâ Le serveur ne sait pas :
  </p>
  <ul>
    <li>si l‚Äôutilisateur a r√©ellement voulu l‚Äôaction</li>
    <li>ou si elle a √©t√© d√©clench√©e √† son insu</li>
  </ul>

  <hr>

  <p><strong>‚úÖ Avec token CSRF (Synchronizer Token)</strong></p>
  <p>Le serveur exige <strong>deux preuves distinctes</strong> :</p>

  <ol>
    <li>
      <strong>Identit√©</strong><br>
      Cookie de session ‚Üí ‚Äúqui est l‚Äôutilisateur‚Äù
    </li>
    <li>
      <strong>Intention</strong><br>
      Token CSRF ‚Üí ‚Äúest-ce que l‚Äôutilisateur a charg√© MON formulaire / MON front‚Äù
    </li>
  </ol>

  <p>
    üëâ Un site malveillant peut d√©clencher une requ√™te,
    <strong>mais il ne peut pas fournir le token CSRF</strong>.
  </p>

  <hr>

  <p><strong>üß† Pourquoi l‚Äôattaquant ne peut pas r√©cup√©rer le token ?</strong></p>
  <ul>
    <li>Le token est g√©n√©r√© par <strong>votre serveur</strong></li>
    <li>Il est stock√© dans le HTML, une balise meta ou un cookie s√©curis√©</li>
    <li>Un site externe ne peut pas lire votre DOM</li>
    <li>üëâ La <strong>Same Origin Policy</strong> bloque l‚Äôacc√®s</li>
  </ul>

  <p>
    ‚û°Ô∏è Le pirate peut forcer une requ√™te,<br>
    ‚û°Ô∏è mais il <strong>ne peut pas deviner ni voler le token</strong>.
  </p>

  <hr>

<p><strong>üß© Exemple c√¥t√© Angular</strong></p>

<p>
  Le token CSRF est fourni par le serveur (cookie, meta, endpoint d√©di√©),
  puis renvoy√© par Angular dans les requ√™tes sensibles.
</p>

<pre><code>// Exemple Angular (HttpClient)
this.http.post(
  '/api/tasks/delete/123',
  {},
  {
    headers: {
      'X-CSRF-TOKEN': csrfToken
    }
  }
);</code></pre>

<p>
  ‚úÖ Si le token est valide ‚Üí requ√™te accept√©e<br>
  ‚ùå Si le token est absent ou incorrect ‚Üí requ√™te refus√©e
</p>
</div>

  <div class="success-box">
  <h3>‚úÖ Cookies SameSite (protection c√¥t√© serveur)</h3>

  <p>
    L‚Äôattribut <strong>SameSite</strong> est configur√©
    <strong>par le serveur</strong> sur le cookie de session.
  </p>

  <p>
    Il indique au navigateur <strong>quand il a le droit d‚Äôenvoyer le cookie</strong>
    lors d‚Äôune requ√™te provenant d‚Äôun autre site.
  </p>

  <p>
    üëâ Objectif : bloquer l‚Äôenvoi automatique du cookie
    lors des requ√™tes <strong>cross-site</strong> (attaque CSRF).
  </p>

  <ul>
    <li><strong>Lax</strong> : bon compromis (recommand√© par d√©faut)</li>
    <li><strong>Strict</strong> : tr√®s s√©curis√©, mais peut bloquer certaines redirections</li>
    <li><strong>None</strong> : autoris√© uniquement avec HTTPS (<code>Secure</code>)</li>
  </ul>

  <hr>

  <p><strong>üß© Exemple de configuration (c√¥t√© serveur)</strong></p>

  <pre><code>Set-Cookie: session=abc123;
  HttpOnly;
  Secure;
  SameSite=Lax;</code></pre>

  <p>
    ‚úÖ Cookie envoy√© lors d‚Äôune navigation normale<br>
    ‚ùå Cookie bloqu√© lors d‚Äôune requ√™te d√©clench√©e depuis un autre site
  </p>
</div>







<div class="info-box">
  <h3>üîç V√©rifier Origin / Referer (c√¥t√© serveur)</h3>

  <p>
    Le serveur peut v√©rifier que la requ√™te
    provient bien de votre domaine
    via les en-t√™tes <code>Origin</code> ou <code>Referer</code>.
  </p>

  <p>
    ‚úÖ Utile en compl√©ment<br>
    ‚ö†Ô∏è Pas suffisant seul (certains navigateurs ou contextes les masquent)
  </p>
</div>
<div class="warning-box">
  <h3>‚ö†Ô∏è Bonnes pratiques API (indispensables)</h3>

  <ul>
    <li>‚ùå Ne jamais modifier des donn√©es avec <code>GET</code></li>
    <li>‚úÖ Actions sensibles ‚Üí <code>POST</code> / <code>PUT</code> / <code>DELETE</code></li>
    <li>‚úÖ Requ√™tes critiques = token CSRF + cookies SameSite</li>
  </ul>
</div>
<div class="success-box">
  <h3>üß© Le r√¥le d‚ÄôAngular face au CSRF</h3>

  <ul>
    <li>Angular prot√®ge le <strong>DOM</strong> ‚Üí XSS</li>
    <li>Angular <strong>n‚Äôemp√™che pas</strong> le CSRF √† lui seul</li>
    <li>Angular sert √† <strong>envoyer le token CSRF</strong> via HttpClient</li>
    <li>La vraie barri√®re est <strong>c√¥t√© serveur</strong></li>
  </ul>

  <p style="margin-top: 1rem;">
    ‚û°Ô∏è S√©curit√© CSRF = <strong>front + navigateur + serveur</strong>
  </p>
</div>
</div>
  



<!-- Slide CSP -->
<div class="slide">
  <h1>üß± CSP (Content Security Policy)</h1>

  <div class="info-box">
    <h3>üîç C‚Äôest quoi ?</h3>
    <p>
      La <strong>Content Security Policy</strong> est une r√®gle de s√©curit√© appliqu√©e par le
      <strong>navigateur</strong> pour limiter ce que la page a le droit de charger/ex√©cuter.
    </p>
    <ul>
      <li>‚úÖ Emp√™che une partie des attaques <strong>XSS</strong> (scripts inject√©s)</li>
      <li>‚úÖ Contr√¥le les sources autoris√©es : <strong>JS</strong>, <strong>CSS</strong>, <strong>images</strong>, <strong>polices</strong>, <strong>API</strong></li>
      <li>‚ö†Ô∏è Ce n‚Äôest pas ‚Äúdu code Angular‚Äù : c‚Äôest une <strong>configuration c√¥t√© serveur</strong></li>
    </ul>
  </div>

  <div class="warning-box">
    <h3>üéØ Pourquoi c‚Äôest important pour Angular ?</h3>
    <p>
      Une CSP trop stricte peut <strong>bloquer des ressources</strong> et ‚Äúcasser‚Äù l‚ÄôUI :
      scripts, styles, fonts, appels r√©seau‚Ä¶
    </p>
    <p style="margin-top: 0.75rem;">
      üëâ Objectif : <strong>autoriser le n√©cessaire</strong> (Angular + API)
      et <strong>bloquer le reste</strong>.
    </p>
  </div>

  <div class="success-box">
    <h3>üõ†Ô∏è Comment on configure (c√¥t√© serveur)</h3>
    <p>
      Le serveur envoie un en-t√™te HTTP au navigateur :
      <code>Content-Security-Policy</code>
    </p>

    <pre><code>// Exemple CSP "compatible Angular" (base simple)
Content-Security-Policy:
  default-src 'self';
  script-src 'self';
  style-src 'self';
  img-src 'self' data: https:;
  font-src 'self' data:;
  connect-src 'self' https://api.example.com;</code></pre>

    <p style="margin-top: 0.75rem;">
      ‚úÖ <strong>script-src</strong> : autorise le JS du m√™me domaine (bundle Angular)<br>
      ‚úÖ <strong>style-src</strong> : autorise les CSS du m√™me domaine<br>
      ‚úÖ <strong>connect-src</strong> : autorise les appels HTTP vers votre API
    </p>
  </div>



  <div class="warning-box">
    <h3>‚ö†Ô∏è Erreurs fr√©quentes</h3>
    <ul>
      <li>‚ùå Oublier <code>connect-src</code> ‚Üí Angular ne peut plus appeler l‚ÄôAPI</li>
      <li>‚ùå Mettre <code>script-src *</code> ‚Üí annule l‚Äôint√©r√™t de la CSP</li>
      <li>‚ö†Ô∏è Ajouter <code>'unsafe-inline'</code> sans raison ‚Üí r√©duit fortement la protection</li>
    </ul>
    <p style="margin-top: 0.75rem;">
      ‚úÖ Bonne pratique : commencer strict, puis ouvrir uniquement ce qui est bloqu√©
      (en regardant les erreurs CSP dans la console).
    </p>
  </div>

  <div class="success-box">
    <h3>üéØ √Ä retenir</h3>
    <p style="font-size: 1.2em;">
      CSP = <strong>la liste blanche</strong> de ce que le navigateur a le droit de charger/ex√©cuter.<br>
      Angular doit fonctionner <strong>dans ces r√®gles</strong>.
    </p>
  </div>
</div>
 

        <!-- Slide 23 -->
        <div class="slide">
            <h1>üìã R√©capitulatif S√©curit√©</h1>
            
            <div class="success-box">
                <h3>‚úÖ Ce qu'Angular fait pour vous</h3>
                <table>
                    <tbody>
                        <tr>
                            <td style="width: 25%; font-weight: bold;">XSS</td>
                            <td>Protection automatique avec {{ }}</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold;">CSRF</td>
                            <td>Tokens automatiques avec HttpClient</td>
                        </tr>
                        <tr>
                            <td style="font-weight: bold;">Sanitization</td>
                            <td>DomSanitizer pour nettoyer le HTML</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="warning-box">
                <h3>‚ö†Ô∏è Ce que VOUS devez faire</h3>
                <ul>
                    <li>‚úÖ Ne jamais utiliser innerHTML sans raison valide</li>
                    <li>‚úÖ Valider les donn√©es c√¥t√© serveur AUSSI</li>
                    <li>‚úÖ Configurer une CSP stricte</li>
                    <li>‚úÖ Ne jamais faire confiance aux donn√©es utilisateur</li>
                    <li>‚úÖ Tester r√©guli√®rement la s√©curit√©</li>
                </ul>
            </div>

            <div class="info-box">
                <h3>üí° R√®gles d'or</h3>
                <ol style="font-size: 1.2em; line-height: 2;">
                    <li><strong>Le front n'est jamais s√ªr √† 100%</strong> ‚Üí S√©curiser le back</li>
                    <li><strong>Angular aide, mais ne fait pas tout</strong> ‚Üí Restez vigilant</li>
                    <li><strong>La s√©curit√© est une mentalit√©</strong> ‚Üí Penser s√©curit√© d√®s la conception</li>
                </ol>
            </div>
        </div>

        <!-- Slide 24 -->
        <div class="slide">
            <h1>üõ†Ô∏è Atelier pratique guid√©</h1>
            
            <div class="info-box">
                <h3>üìã Partie 1 : Audit de performance (30 min)</h3>
                <ol>
                    <li><strong>Installer Angular DevTools</strong>
                        <ul><li>Chrome Web Store ‚Üí "Angular DevTools"</li></ul>
                    </li>
                    <li><strong>Lancer un profiling</strong>
                        <ul>
                            <li>DevTools ‚Üí Angular ‚Üí Profiler</li>
                            <li>Enregistrer une action (ajouter une t√¢che)</li>
                            <li>Identifier combien de composants se rafra√Æchissent</li>
                        </ul>
                    </li>
                    <li><strong>Audit Lighthouse</strong>
                        <ul>
                            <li>DevTools ‚Üí Lighthouse ‚Üí Performance</li>
                            <li>Noter le score actuel</li>
                            <li>Identifier les probl√®mes principaux</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="success-box">
                <h3>üîß Partie 2 : Optimisations (30 min)</h3>
                <ol>
                    <li>Ajouter OnPush sur TasksPageComponent</li>
                    <li>V√©rifier le tracking (<code>track</code>) dans toutes les boucles de template</li>
                    <li>Relancer Lighthouse et comparer les scores</li>
                </ol>
            </div>

            <div class="warning-box">
                <h3>üîí Partie 3 : Audit de s√©curit√© (20 min)</h3>
                <ol>
                    <li>Chercher les innerHTML dans le code</li>
                    <li>V√©rifier qu'aucun script inline n'est utilis√©</li>
                    <li>Tester l'ajout d'une t√¢che avec du HTML malveillant</li>
                </ol>
            </div>
        </div>

        <!-- Slide 25 -->
        <div class="slide">
            <h1>üìö Synth√®se de la s√©quence</h1>
            
            <div class="success-box">
                <h3>‚ö° Performance : Les 5 r√®gles d'or</h3>
                <ol style="font-size: 1.2em; line-height: 2;">
                    <li><strong>Mesurer avant d'optimiser</strong> (DevTools + Lighthouse)</li>
                    <li><strong>OnPush sur les composants</strong> (r√©duit les v√©rifications)</li>
                    <li><strong>trackBy dans les listes</strong> (optimise le DOM)</li>
                    <li><strong>Lazy Loading</strong> (r√©duit le bundle initial)</li>
                    <li><strong>D√©couper en composants</strong> (facilite l'optimisation)</li>
                </ol>
            </div>

            <div class="info-box">
                <h3>üîí S√©curit√© : Les 5 commandements</h3>
                <ol style="font-size: 1.2em; line-height: 2;">
                    <li><strong>Ne jamais faire confiance aux donn√©es utilisateur</strong></li>
                    <li><strong>Utiliser {{ }} au lieu de innerHTML</strong></li>
                    <li><strong>Valider c√¥t√© serveur AUSSI</strong></li>
                    <li><strong>Configurer une CSP stricte</strong></li>
                    <li><strong>Tester r√©guli√®rement</strong></li>
                </ol>
            </div>

            <div class="highlight" style="text-align: center; padding: 40px;">
                <h2 style="font-size: 2em; color: #667eea;">
                    "Performance = Conception + Mesure"<br>
                    "S√©curit√© = Bonnes pratiques + Vigilance"<br>
                    "Angular aide, mais ne fait pas tout seul"
                </h2>
            </div>
        </div>

        <div class="controls">
            <button id="prev-btn">‚Üê Pr√©c√©dent</button>
            <button id="next-btn">Suivant ‚Üí</button>
        </div>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentSlideSpan = document.getElementById('current-slide');
        const totalSlidesSpan = document.getElementById('total-slides');

        totalSlidesSpan.textContent = totalSlides;

        function showSlide(n) {
            slides.forEach(slide => slide.classList.remove('active'));
            slides[n].classList.add('active');
            currentSlideSpan.textContent = n + 1;
            
            prevBtn.disabled = n === 0;
            nextBtn.disabled = n === totalSlides - 1;
            
            slides[n].scrollTop = 0;
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                showSlide(currentSlide);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        }

        nextBtn.addEventListener('click', nextSlide);
        prevBtn.addEventListener('click', prevSlide);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });

        showSlide(0);
    </script>
</body>
</html>